{"title":"加载离线瓦片地图","date":"2020-04-13T05:38:08.000Z","date_formatted":{"ll":"Apr 13, 2020","L":"04/13/2020","MM-DD":"04-13"},"link":"2020/04/13/OpenLayers_8","comments":true,"tags":["OpenLayers","Source And Layer"],"categories":["学习笔记"],"updated":"2020-04-13T12:13:38.132Z","content":"<p>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 地图设置中心，设置到成都，在本地离线地图 offlineMapTiles刚好有一张zoom为4的成都瓦片</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> center = ol.proj.transform([<span class=\"number\">104.06667</span>, <span class=\"number\">30.66667</span>], <span class=\"string\">'EPSG:4326'</span>, <span class=\"string\">'EPSG:3857'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//创建地图</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> ol.Map(&#123;</span><br><span class=\"line\">    view: <span class=\"keyword\">new</span> ol.View(&#123; </span><br><span class=\"line\">        center: center,</span><br><span class=\"line\">        zoom: <span class=\"number\">4</span> </span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    target: <span class=\"string\">'map'</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 添加一个使用离线瓦片地图的层</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> offlineMapLayer = <span class=\"keyword\">new</span> ol.layer.Tile(&#123;</span><br><span class=\"line\">    source: <span class=\"keyword\">new</span> ol.source.XYZ(&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 设置本地离线瓦片所在路径，由于例子里面只有一张瓦片，页面显示时就只看得到一张瓦片。</span></span><br><span class=\"line\">        url: <span class=\"string\">'../src/05-04/offlineMapTiles/&#123;z&#125;/&#123;x&#125;/&#123;y&#125;.png'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">map.addLayer(offlineMapLayer);</span><br></pre></td></tr></table></figure>\n<p>其中的主要内容很简单，与在线的瓦片地图加载的唯一不同，只有url路径的不同，这里的url:<code>../src/05-04/offlineMapTiles/{z}/{x}/{y}.png&#39;</code>也就是存储离线地图的相对路径。需要注意的是， <strong>在路径中要能体现该瓦片的<code>/{z}/{x}/{y}</code>用于显示</strong> ，其他参数也可以通过这种方法来设置；</p>\n","prev":{"title":"万能瓦片地图加载秘籍","link":"2020/04/13/OpenLayers_7"},"next":{"title":"加载静态地图","link":"2020/04/13/OpenLayers_9"},"plink":"http://yoursite.com/2020/04/13/OpenLayers_8/","reward":true,"copyright":{"custom":"<b>Copyright : </b>&nbsp 自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0） <br/>  <b>Link :</b> &nbsp<a href=\"https://qlqy.github.io\">https://qlqy.github.io</a>"}}