{"title":"OpenLayers--View实例","date":"2020-04-05T03:44:08.000Z","date_formatted":{"ll":"Apr 5, 2020","L":"04/05/2020","MM-DD":"04-05"},"link":"2020/04/05/OpenLayers_5","comments":true,"tags":["OpenLayers","View"],"categories":["学习笔记"],"updated":"2020-04-08T12:56:59.945Z","content":"<h3 id=\"限制地图范围\">限制地图范围<a href=\"#限制地图范围\" title=\"限制地图范围\"></a></h3><p>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      view: <span class=\"keyword\">new</span> ol.View(&#123;</span><br><span class=\"line\">          <span class=\"comment\">// 设置地图中心范围</span></span><br><span class=\"line\">          extent: [<span class=\"number\">102</span>, <span class=\"number\">29</span>, <span class=\"number\">104</span>, <span class=\"number\">31</span>],</span><br><span class=\"line\">          <span class=\"comment\">// 设置成都为地图中心</span></span><br><span class=\"line\">          center: [<span class=\"number\">104.06</span>, <span class=\"number\">30.67</span>],</span><br><span class=\"line\">          projection: <span class=\"string\">'EPSG:4326'</span>,</span><br><span class=\"line\">          zoom: <span class=\"number\">10</span></span><br><span class=\"line\">      &#125;),</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<ul><li><strong>主要功能代码：</strong><code>extent: [102, 29, 104, 31]</code>-&gt;<code>extent: [minX, minY, maxX, maxY]</code>-&gt;<code>ol.Extent</code></li>\n<li><strong>存在的问题：</strong><code>extent</code>参数限制的是地图中心的限制范围，而非整个地图显示的范围，也就是所地图缩小后该范围外的区域也会显示出来。</li>\n<li><strong>解决方法：</strong> 限制地图缩放级别，使之不能缩小，但仍是指标不治本。<h3 id=\"限制地图缩放级别\">限制地图缩放级别<a href=\"#限制地图缩放级别\" title=\"限制地图缩放级别\"></a></h3>代码如下：<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      view: <span class=\"keyword\">new</span> ol.View(&#123;</span><br><span class=\"line\">          <span class=\"comment\">// 设置成都为地图中心</span></span><br><span class=\"line\">          center: [<span class=\"number\">104.06</span>, <span class=\"number\">30.67</span>],</span><br><span class=\"line\">          projection: <span class=\"string\">'EPSG:4326'</span>,</span><br><span class=\"line\">          zoom: <span class=\"number\">10</span>,</span><br><span class=\"line\">          <span class=\"comment\">// 限制地图缩放最大级别为14，最小级别为10</span></span><br><span class=\"line\">          minZoom: <span class=\"number\">10</span>,</span><br><span class=\"line\">          maxZoom: <span class=\"number\">14</span></span><br><span class=\"line\">      &#125;),</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></li>\n<li><strong>主要功能代码：</strong><code>minZoom: 10</code>和<code>maxZoom: 14</code></li>\n<li><strong>说明：</strong><code>minZoom</code>和<code>maxZoom</code>是可以单独使用的，即只限制最大或最小缩放级别。<h3 id=\"自适配区域\">自适配区域<a href=\"#自适配区域\" title=\"自适配区域\"></a></h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"map\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"width: 100%\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"显示成都\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"fitToChengdu();\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">      <span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> ol.Map(&#123;</span></span><br><span class=\"line\">            layers: [</span><br><span class=\"line\"><span class=\"actionscript\">                <span class=\"keyword\">new</span> ol.layer.Tile(&#123;source: <span class=\"keyword\">new</span> ol.source.OSM()&#125;)</span></span><br><span class=\"line\">            ],</span><br><span class=\"line\"><span class=\"actionscript\">            view: <span class=\"keyword\">new</span> ol.View(&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">                <span class=\"comment\">// 设置成都为地图中心</span></span></span><br><span class=\"line\">                center: [104.06, 30.67],</span><br><span class=\"line\"><span class=\"actionscript\">                projection: <span class=\"string\">'EPSG:4326'</span>,</span></span><br><span class=\"line\">                zoom: 10</span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\"><span class=\"actionscript\">            target: <span class=\"string\">'map'</span></span></span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"actionscript\">      <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fitToChengdu</span><span class=\"params\">()</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">          <span class=\"comment\">// 让地图最大化完全地显示区域[104, 30.6, 104.12, 30.74]</span></span></span><br><span class=\"line\">          map.getView().fit([104, 30.6, 104.12, 30.74], map.getSize());</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li><strong>主要功能代码：</strong><code>map.getView().fit([104, 30.6, 104.12, 30.74], map.getSize());</code></li>\n<li><strong>说明：</strong> 上述代码的含义点击按钮后，触发事件。即获取地图的视图（<code>map.getView()</code>），并通过 <code>ol.View</code>的<code>fit()</code>函数来修改当前的视图。其中<code>fit()</code>的第一个属性是<code>geometryOrExtent</code>也就是当前的视图中需要转换成的范围或其他几何结构（有很多表示形式–API）；第二个属性<code>map.getSize()</code>是使改变后的地图视图的大小尺寸仍然用之前的设置，当然也可以改变，对应的是<code>size</code>属性；fit还有其他很多属性，如<code>padding</code>/<code>nearest</code>等，可以用于很多地图方面的自适应，其具体应用如下：<br><img src=\"http://m.qpic.cn/psc?/V13pj9aA3RC40Y/YWvjNfAyIVey1fwA2tD8GBwuFIXLCgL5O3PsA3ZEoM6lG1RjUtsPHEr0k2jZAdyEkf.ADcFDEKQS0H6GCjrnex7oVBf9DPt568r6pVxNDPo!/b&amp;bo=EQS7AQAAAAADF50!&amp;rf=viewer_4\" class=\"φcy\" alt=\"fit_options\"></li>\n</ul>","prev":{"title":"OpenLayers 3使用的坐标系","link":"2020/04/05/OpenLayers_4"},"next":{"title":"加载在线地图","link":"2020/04/05/OpenLayers_6"},"plink":"http://yoursite.com/2020/04/05/OpenLayers_5/","toc":[{"id":"限制地图范围","title":"限制地图范围","index":"1"},{"id":"限制地图缩放级别","title":"限制地图缩放级别","index":"2"},{"id":"自适配区域","title":"自适配区域","index":"3"}],"reward":true,"copyright":{"custom":"<b>Copyright : </b>&nbsp 自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0） <br/>  <b>Link :</b> &nbsp<a href=\"https://qlqy.github.io\">https://qlqy.github.io</a>"}}